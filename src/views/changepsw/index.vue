<template>
	<div class="register-container view-container">
		<section>
			
			<div class="form-content" v-loading="loading">

				<header>修改密码</header>

				<el-form :model="changepswform" :rules="changepswRules" ref="changepswform" class="demo-ruleForm" @keyup.enter.native="submitForm('changepswform')">

					<div class="oldpsw-input">
						<el-form-item prop="oldpassword" class="form-inputy">
							<el-input type="password" v-model="changepswform.oldpassword" placeholder="原密码">
								<icon-svg icon-class="mima" class="mima-icon" slot="prefix"></icon-svg>
							</el-input>
						</el-form-item>
					</div>

					<div class="psw-input">
						<el-form-item prop="password" class="form-inputy">
							<el-input type="password" v-model="changepswform.newpassword" placeholder="输入密码">
								<icon-svg icon-class="mima" class="mima-icon" slot="prefix"></icon-svg>
							</el-input>
						</el-form-item>
					</div>

					<div class="cofpsw-input">
						<el-form-item prop="confirmpassword" class="form-inputy">
							<el-input type="password" v-model="changepswform.confirmpassword" auto-complete="off" placeholder="请再输入一遍">
								<icon-svg icon-class="mima" class="mima-icon" slot="prefix"></icon-svg>
							</el-input>
						</el-form-item>
					</div>
					<el-form-item class="form-btny">
						<el-button type="primary" :loading="loading" @click="submitForm('changepswform')">修改</el-button>
					</el-form-item>
				</el-form>
			</div>
		</section>
	</div>
</template>
<script>
  import { mapGetters } from 'vuex';
  import { changepassword } from 'api/user';

  export default {
    name: 'changepsw',
    data() {
      // element-ui validator
      var validatePassword = (rule, value, callback) => {
        if (value === '') {
          callback(new Error('请输入密码'));
        }else if(value.length < 6 || value.length>20){
          callback(new Error('请填写6-20位密码'));
        } else {
          callback();
        }
      };
      var validatePassword2 = (rule, value, callback) => {
        if (value === '') {
          callback(new Error('请输入密码'));
        }else if(value.length < 6 || value.length>20){
          callback(new Error('请填写6-20位密码'));
        }else if(value!==this.changepswform.password){
          callback(new Error('请确认新密码一致！'));
        } else {
          callback();
        }
      };
      return {
        activeName: 'changepsw',
        loading: false,

        // form part
        changepswform: {
          oldpassword: '',
          password:'',
          confirmpassword: '',
          token: '',
        },
        changepswRules: {
          oldpassword: [
            { validator: validatePassword, trigger: 'blur' }
          ],
          password: [
            { validator: validatePassword, trigger: 'blur' }
          ],
          confirmpassword: [
            { validator: validatePassword2, trigger: 'blur' }
          ],
        }
      }
    },
    computed: {
      ...mapGetters([
        'user',
      ])
    },
    mounted() {
    },
    methods: {
      submitForm(formName){
        this.$refs[formName].validate((valid) => {

        });
      },
    },
  }
</script>
<style rel="stylesheet/scss" lang="scss" scoped>
	.register-container {
		display: flex;
		justify-content: space-between;
		margin: auto;
		max-width: 828px;
		min-width: 380px;
		padding-top: 102px;
		section {
			flex: 1;

			.form-content {
				width: 100%;
				background: #ffffff;
				/*background: #C0C0C0;*/
				width: 828px;
				height: 713px;
				margin: 0 auto;
				justify-content: center;

				header {
					margin: 0 auto;
					padding-top: 42px;
					font-size: 32px;
					color: #5677fc;
					text-align: center;
				}
        
        .el-form-item {
					margin-bottom: 0px;

					/deep/ .el-form-item__error {
						padding-top: 11px;
						height: 15px;
						font-size: 14px;
						color: #e60012;
					}
				}

				.el-input {
					width: 405px;
					/deep/ input {
						padding-left: 17px;
						font-size: 28px;
						height: 74px;
						color: #434343;
						background-color: rgba(248, 249, 250, 0.45);
						box-shadow: -3px 0px 7px 0px rgba(99, 99, 99, 0.16);
						border-radius: 4px;
						border: solid 2px rgba(171, 171, 171, 0.45);
						&:focus {
							background-color: rgba(248, 249, 250, 0.4);
							box-shadow: 0px 3px 7px 0px rgba(86, 119, 252, 0.14);
							border-radius: 4px;
							border: solid 2px rgba(0, 64, 185, 0.4);
						}
						&::-webkit-input-placeholder {
							font-size: 20px;
							color: #434343;
							margin-top: 26px;
						}
					}
				}

				.oldpsw-input {
					width: 458px;
					margin: 0 auto;
					padding-top: 58px;
					padding-left: 53px;
					.svg-icon {
						width: 33px;
						height: 33px;
						color: #5677fc;
						margin: 19.5px 0 19.5px -88px;
					}
				}
				.psw-input {
					width: 458px;
					margin: 0 auto;
					padding-top: 72px;
					padding-left: 53px;
					.svg-icon {
						width: 33px;
						height: 33px;
						color: #5677fc;
						margin: 19.5px 0 19.5px -88px;
					}
				}
        .cofpsw-input {
          width: 458px;
          margin: 0 auto;
          padding-top: 72px;
          padding-left: 53px;
          .svg-icon {
						width: 33px;
						height: 33px;
						color: #5677fc;
						margin: 19.5px 0 19.5px -88px;
					}
        }

				.form-btny {
					text-align: center;
					width: 458px;
					height: 142px;
					padding-top: 71px;
					margin: 0 auto;
					button {
						padding: 0;
						width: 458px;
						height: 71px;
						background-color: #5677fc;
						border-radius: 4px;
						font-size: 24px;
						color: #ffffff;
					}
				}
			}
		}
	}
</style>